<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <!-- SEO Meta Tags -->
  <title>AI Receptionist - Your Virtual Assistant</title>
  <meta name="description" content="Professional AI-powered virtual receptionist that screens calls, takes messages, and manages contacts intelligently.">
  <meta name="keywords" content="AI receptionist, virtual assistant, call screening, message taking">
  <meta name="robots" content="index, follow">
  
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="AI Receptionist - Professional Virtual Assistant">
  <meta property="og:description" content="Never miss important calls. AI receptionist available 24/7.">
  
  <!-- Mobile App Meta -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0066ff">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --primary: #0066ff;
      --primary-dark: #0052cc;
      --success: #10b981;
      --error: #ef4444;
      --warning: #f59e0b;
      --bg: #0a0e1a;
      --card: rgba(15, 23, 42, 0.9);
      --muted: #94a3b8;
      --text: #e2e8f0;
      --border: rgba(51, 65, 85, 0.5);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: linear-gradient(135deg, #0a0e1a 0%, #0f1729 50%, #0a0e1a 100%);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 0;
      margin-bottom: 30px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 700;
      font-size: 1.25rem;
    }

    .card {
      background: var(--card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      border: none;
      border-radius: 12px;
      padding: 12px 24px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }

    .btn-ghost {
      background: rgba(30, 41, 59, 0.5);
      border: 1px solid var(--border);
      color: var(--text);
    }

    .input {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border);
      background: rgba(15, 23, 42, 0.5);
      color: var(--text);
      border-radius: 12px;
      font-size: 0.95rem;
    }

    .input:focus {
      outline: none;
      border-color: var(--primary);
    }

    .grid {
      display: grid;
      gap: 20px;
    }

    .grid-2 {
      grid-template-columns: repeat(2, 1fr);
    }

    @media (max-width: 768px) {
      .grid-2 {
        grid-template-columns: 1fr;
      }
    }

    .hidden {
      display: none !important;
    }

    .chat-container {
      height: 450px;
      display: flex;
      flex-direction: column;
      background: rgba(15, 23, 42, 0.3);
      border-radius: 16px;
      overflow: hidden;
    }

    .chat-header {
      padding: 16px;
      background: rgba(30, 41, 59, 0.5);
      border-bottom: 1px solid var(--border);
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .bubble {
      max-width: 75%;
      padding: 12px 16px;
      border-radius: 16px;
      word-break: break-word;
    }

    .bubble.me {
      background: var(--primary);
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }

    .bubble.ai {
      background: rgba(30, 41, 59, 0.5);
      border: 1px solid var(--border);
      align-self: flex-start;
      border-bottom-left-radius: 4px;
    }

    .chat-input-area {
      padding: 16px;
      background: rgba(30, 41, 59, 0.5);
      border-top: 1px solid var(--border);
      display: flex;
      gap: 12px;
    }

    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--card);
      border: 1px solid var(--border);
      padding: 14px 20px;
      border-radius: 12px;
      z-index: 1000;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid var(--border);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- Toast Notification -->
  <div id="toast" class="toast hidden"></div>

  <div class="container">
    <!-- Navigation -->
    <nav class="nav">
      <div class="brand">
        <span>ðŸ¤– AI Receptionist</span>
      </div>
      <div id="authButtons">
        <button id="btnLogin" class="btn btn-ghost">Sign In</button>
        <button id="btnRegister" class="btn btn-primary">Get Started</button>
      </div>
      <div id="userMenu" class="hidden">
        <span id="userName"></span>
        <button id="btnDashboard" class="btn btn-ghost">Dashboard</button>
        <button id="btnLogout" class="btn btn-ghost">Sign Out</button>
      </div>
    </nav>

    <!-- Landing Page -->
    <section id="landing">
      <div class="card" style="text-align: center; padding: 60px 30px;">
        <h1 style="font-size: 2.5rem; margin-bottom: 20px;">Your AI Receptionist is Ready</h1>
        <p style="font-size: 1.1rem; color: var(--muted); margin-bottom: 40px;">
          Never miss an important call. Our AI assistant handles your communications 24/7.
        </p>
        <div style="display: flex; gap: 20px; justify-content: center;">
          <button onclick="showRegister()" class="btn btn-primary">Start Free Trial</button>
          <button onclick="showDemo()" class="btn btn-ghost">View Demo</button>
        </div>
      </div>
    </section>

    <!-- Owner Dashboard -->
    <section id="dashboard" class="hidden">
      <div class="card">
        <h2>Welcome, <span id="ownerName">User</span></h2>
        <p style="color: var(--muted); margin: 10px 0;">Your receptionist link:</p>
        <div style="display: flex; gap: 10px; margin: 20px 0;">
          <input id="shareLink" class="input" readonly style="flex: 1;">
          <button id="btnCopy" class="btn btn-primary">Copy Link</button>
        </div>
      </div>

      <div class="grid grid-2">
        <div class="card">
          <h3>Statistics</h3>
          <div style="margin: 20px 0;">
            <div>Total Calls: <strong id="totalCalls">0</strong></div>
            <div>Messages: <strong id="totalMessages">0</strong></div>
          </div>
        </div>

        <div class="card">
          <h3>Recent Activity</h3>
          <div id="recentActivity" style="margin: 20px 0;">
            <p style="color: var(--muted);">No recent activity</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Public Call Interface -->
    <section id="callInterface" class="hidden">
      <div class="card">
        <h2>Contact <span id="recipientName">User</span></h2>
        <form id="callerForm" class="grid">
          <input id="callerName" class="input" placeholder="Your Name" required>
          <input id="callerPhone" class="input" placeholder="Phone Number">
          <textarea id="callerReason" class="input" rows="3" placeholder="Reason for calling"></textarea>
          <button type="submit" class="btn btn-primary">Start Conversation</button>
        </form>
      </div>

      <div id="chatUI" class="card hidden" style="padding: 0;">
        <div class="chat-container">
          <div class="chat-header">
            <strong>AI Receptionist</strong>
            <span id="chatStatus" style="float: right; color: var(--muted);">Connected</span>
          </div>
          <div id="chatMessages" class="chat-messages"></div>
          <form id="chatForm" class="chat-input-area">
            <input id="chatInput" class="input" placeholder="Type your message..." style="flex: 1;">
            <button type="submit" class="btn btn-primary">Send</button>
            <button type="button" id="btnEnd" class="btn btn-ghost">End</button>
          </form>
        </div>
      </div>
    </section>

    <!-- Auth Modal -->
    <div id="authModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 1000;">
      <div class="card" style="width: 400px; max-width: 90%;">
        <h2 id="authTitle">Sign In</h2>
        <form id="authForm" class="grid" style="margin-top: 20px;">
          <input id="authEmail" type="email" class="input" placeholder="Email" required>
          <input id="authPassword" type="password" class="input" placeholder="Password" required>
          <input id="authName" class="input hidden" placeholder="Full Name">
          <button type="submit" class="btn btn-primary">Continue</button>
          <button type="button" onclick="closeAuth()" class="btn btn-ghost">Cancel</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Configuration - Update these values
    const API_BASE = 'http://localhost:5000';  // Your API endpoint
    
    // Application State
    const state = {
      token: localStorage.getItem('ai_token') || null,
      user: null,
      sessionId: null,
      shareSlug: null
    };

    // DOM Helpers
    const $ = id => document.getElementById(id);
    const show = id => $(id)?.classList.remove('hidden');
    const hide = id => $(id)?.classList.add('hidden');
    
    // Toast Notification
    function toast(message, type = 'info') {
      const t = $('toast');
      t.textContent = message;
      t.className = `toast ${type}`;
      show('toast');
      setTimeout(() => hide('toast'), 3000);
    }

    // Initialize App
    document.addEventListener('DOMContentLoaded', () => {
      const urlParams = new URLSearchParams(window.location.search);
      const callSlug = urlParams.get('call');
      
      if (callSlug) {
        // Public call mode
        loadCallInterface(callSlug);
      } else if (state.token) {
        // User is logged in
        loadDashboard();
      } else {
        // Show landing page
        show('landing');
      }
      
      setupEventListeners();
    });

    // Event Listeners
    function setupEventListeners() {
      $('btnLogin')?.addEventListener('click', () => showAuth('login'));
      $('btnRegister')?.addEventListener('click', () => showAuth('register'));
      $('btnLogout')?.addEventListener('click', logout);
      $('btnCopy')?.addEventListener('click', copyLink);
      $('authForm')?.addEventListener('submit', handleAuth);
      $('callerForm')?.addEventListener('submit', startConversation);
      $('chatForm')?.addEventListener('submit', sendMessage);
      $('btnEnd')?.addEventListener('click', endConversation);
    }

    // Authentication
    function showAuth(mode) {
      show('authModal');
      $('authTitle').textContent = mode === 'register' ? 'Create Account' : 'Sign In';
      if (mode === 'register') {
        show('authName');
      } else {
        hide('authName');
      }
      $('authForm').dataset.mode = mode;
    }

    function closeAuth() {
      hide('authModal');
      $('authForm').reset();
    }

    async function handleAuth(e) {
      e.preventDefault();
      const mode = e.target.dataset.mode;
      const data = {
        email: $('authEmail').value,
        password: $('authPassword').value
      };
      
      if (mode === 'register') {
        data.name = $('authName').value;
      }
      
      try {
        const response = await fetch(`${API_BASE}/v1/auth/${mode}`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (result.status === 'success' || result.token) {
          state.token = result.token;
          localStorage.setItem('ai_token', result.token);
          closeAuth();
          toast('Welcome!', 'success');
          loadDashboard();
        } else {
          toast(result.error || 'Authentication failed', 'error');
        }
      } catch (error) {
        toast('Connection error', 'error');
      }
    }

    function logout() {
      state.token = null;
      state.user = null;
      localStorage.removeItem('ai_token');
      hide('dashboard');
      hide('userMenu');
      show('authButtons');
      show('landing');
      toast('Signed out');
    }

    // Dashboard
    async function loadDashboard() {
      try {
        // Get user info
        const userResponse = await fetch(`${API_BASE}/v1/auth/me`, {
          headers: { 'Authorization': `Bearer ${state.token}` }
        });
        const userData = await userResponse.json();
        state.user = userData.user;
        
        // Get share link
        const linkResponse = await fetch(`${API_BASE}/v1/receptionist/link`, {
          headers: { 'Authorization': `Bearer ${state.token}` }
        });
        const linkData = await linkResponse.json();
        
        // Get analytics
        const statsResponse = await fetch(`${API_BASE}/v1/receptionist/analytics?timeframe=7d`, {
          headers: { 'Authorization': `Bearer ${state.token}` }
        });
        const statsData = await statsResponse.json();
        
        // Update UI
        $('ownerName').textContent = state.user?.name || 'User';
        $('userName').textContent = state.user?.name || 'User';
        $('shareLink').value = linkData.url || window.location.origin + '/recai.html?call=' + linkData.slug;
        $('totalCalls').textContent = statsData?.call_statistics?.total_calls || 0;
        $('totalMessages').textContent = statsData?.call_statistics?.messages_taken || 0;
        
        hide('landing');
        hide('authButtons');
        show('userMenu');
        show('dashboard');
        
      } catch (error) {
        console.error('Dashboard error:', error);
        toast('Error loading dashboard', 'error');
      }
    }

    function copyLink() {
      const link = $('shareLink').value;
      navigator.clipboard.writeText(link).then(() => {
        toast('Link copied!', 'success');
      });
    }

    // Call Interface
    async function loadCallInterface(slug) {
      try {
        const response = await fetch(`${API_BASE}/v1/receptionist/public/target?slug=${slug}`);
        const data = await response.json();
        
        if (data.status === 'success') {
          $('recipientName').textContent = data.user?.name || 'User';
          state.shareSlug = slug;
          hide('landing');
          show('callInterface');
        } else {
          toast('Invalid link', 'error');
        }
      } catch (error) {
        toast('Connection error', 'error');
      }
    }

    async function startConversation(e) {
      e.preventDefault();
      
      const callerInfo = {
        name: $('callerName').value,
        phone: $('callerPhone').value,
        initial_message: $('callerReason').value
      };
      
      try {
        const response = await fetch(`${API_BASE}/v1/receptionist/public/start`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            slug: state.shareSlug,
            caller_info: callerInfo
          })
        });
        
        const data = await response.json();
        
        if (data.status === 'success') {
          state.sessionId = data.session_id;
          hide('callerForm');
          show('chatUI');
          addMessage(data.greeting, 'ai');
        } else {
          toast('Could not start conversation', 'error');
        }
      } catch (error) {
        toast('Connection error', 'error');
      }
    }

    async function sendMessage(e) {
      e.preventDefault();
      const input = $('chatInput');
      const message = input.value.trim();
      
      if (!message) return;
      
      input.value = '';
      addMessage(message, 'me');
      
      try {
        const response = await fetch(`${API_BASE}/v1/receptionist/public/message`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            session_id: state.sessionId,
            message: message
          })
        });
        
        const data = await response.json();
        
        if (data.status === 'success') {
          addMessage(data.response, 'ai');
        }
      } catch (error) {
        toast('Error sending message', 'error');
      }
    }

    function addMessage(text, sender) {
      const messages = $('chatMessages');
      const bubble = document.createElement('div');
      bubble.className = `bubble ${sender}`;
      bubble.textContent = text;
      messages.appendChild(bubble);
      messages.scrollTop = messages.scrollHeight;
    }

    async function endConversation() {
      if (!confirm('End this conversation?')) return;
      
      try {
        await fetch(`${API_BASE}/v1/receptionist/public/end`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ session_id: state.sessionId })
        });
        
        toast('Thank you for your message!', 'success');
        setTimeout(() => window.location.href = '/', 2000);
      } catch (error) {
        toast('Error ending conversation', 'error');
      }
    }

    // Demo Functions
    function showRegister() {
      showAuth('register');
    }

    function showDemo() {
      // Add demo video or walkthrough
      toast('Demo coming soon!', 'info');
    }
  </script>
</body>
</html>
